# Correspondances de correction d'encodage
# Pour fichiers JSON-LD TSCG (M2_MetaConcepts.jsonld, M3_*.jsonld, etc.)
# Auteur: Echopraxium with the collaboration of Claude AI
# Date: 2026-01-30

# ==============================================================================
# SYMBOLES MATHÉMATIQUES
# ==============================================================================

## Opérateurs de produit tensoriel
âŠ—           →  ⊗  (U+2297)  # Tensor product / Produit tensoriel
Ã¢Å â€"      →  ⊗  (U+2297)  # Forme corrompue alternative
Ã¢â€ â€™    →  ⊗  (U+2297)  # Autre forme corrompue

## Flèches
â†'          →  →  (U+2192)  # Rightwards arrow / Flèche droite
â‡           →  ⇒  (U+21D2)  # Rightwards double arrow / Double flèche
←            →  ←  (U+2190)  # Leftwards arrow
↔            →  ↔  (U+2194)  # Left-right arrow

## Théorie des ensembles
âˆˆ           →  ∈  (U+2208)  # Element of / Appartient à
âˆ‰           →  ∉  (U+2209)  # Not element of
âŠ†           →  ⊆  (U+2286)  # Subset or equal / Sous-ensemble ou égal
âŠ‚           →  ⊂  (U+2282)  # Subset / Sous-ensemble strict
âŠ•           →  ⊕  (U+2295)  # Direct sum / Somme directe
âˆ©           →  ∩  (U+2229)  # Intersection
âˆª           →  ∪  (U+222A)  # Union
âˆ…           →  ∅  (U+2205)  # Empty set / Ensemble vide

## Comparaisons et relations
â‰            →  ≈  (U+2248)  # Approximately equal / Approximativement égal
â‰ƒ           →  ≃  (U+2243)  # Asymptotically equal
â‰¤           →  ≤  (U+2264)  # Less than or equal / Inférieur ou égal
â‰¥           →  ≥  (U+2265)  # Greater than or equal / Supérieur ou égal
â‰            →  ≠  (U+2260)  # Not equal / Différent de
â‰¡           →  ≡  (U+2261)  # Identical to / Identique à

## Quantificateurs logiques
âˆ€           →  ∀  (U+2200)  # For all / Pour tout
âˆƒ           →  ∃  (U+2203)  # There exists / Il existe
Â¬            →  ¬  (U+00AC)  # Not / Négation logique
âˆ§           →  ∧  (U+2227)  # Logical and / Et logique
âˆ¨           →  ∨  (U+2228)  # Logical or / Ou logique

## Opérateurs mathématiques
âˆ'           →  ∑  (U+2211)  # Summation / Somme
âˆ«           →  ∫  (U+222B)  # Integral / Intégrale
âˆ‚           →  ∂  (U+2202)  # Partial differential / Dérivée partielle
âˆ‡           →  ∇  (U+2207)  # Nabla / Gradient
âˆž           →  ∞  (U+221E)  # Infinity / Infini
âˆ            →  √  (U+221A)  # Square root / Racine carrée
Ã—            →  ×  (U+00D7)  # Multiplication
Ã·            →  ÷  (U+00F7)  # Division
Â±            →  ±  (U+00B1)  # Plus-minus / Plus ou moins
âˆ"           →  ∓  (U+2213)  # Minus-plus

## Crochets et délimiteurs
âŸ¨           →  ⟨  (U+27E8)  # Left angle bracket / Crochet gauche
âŸ©           →  ⟩  (U+27E9)  # Right angle bracket / Crochet droit
âŒˆ           →  ⌈  (U+2308)  # Left ceiling
âŒ‰           →  ⌉  (U+2309)  # Right ceiling
âŒŠ           →  ⌊  (U+230A)  # Left floor
âŒ‹           →  ⌋  (U+230B)  # Right floor

## Divers mathématiques
âˆ¥           →  ∥  (U+2225)  # Parallel to
âŠ¥           →  ⊥  (U+22A5)  # Perpendicular / Orthogonal
âˆ             →  ∝  (U+221D)  # Proportional to / Proportionnel à
âˆ¼           →  ∼  (U+223C)  # Tilde operator / Similaire à
â‰…           →  ≅  (U+2245)  # Approximately equal to / Isomorphe
âŠ—           →  ⊗  (U+2297)  # Circled times / Produit tensoriel

# ==============================================================================
# LETTRES GRECQUES (MINUSCULES)
# ==============================================================================

Î±            →  α  (U+03B1)  # alpha
Î²            →  β  (U+03B2)  # beta
Î³            →  γ  (U+03B3)  # gamma
Î´ / Î"       →  δ  (U+03B4)  # delta
Îµ            →  ε  (U+03B5)  # epsilon
Î¶            →  ζ  (U+03B6)  # zeta
Î·            →  η  (U+03B7)  # eta
Î¸            →  θ  (U+03B8)  # theta
Î¹            →  ι  (U+03B9)  # iota
Îº            →  κ  (U+03BA)  # kappa
Î»            →  λ  (U+03BB)  # lambda
Âµ / Î¼       →  μ  (U+03BC)  # mu
Î½            →  ν  (U+03BD)  # nu
Î¾            →  ξ  (U+03BE)  # xi
Î¿            →  ο  (U+03BF)  # omicron
Ï€            →  π  (U+03C0)  # pi
Ï            →  ρ  (U+03C1)  # rho
Ïƒ            →  σ  (U+03C3)  # sigma
Ï„            →  τ  (U+03C4)  # tau
Ï…            →  υ  (U+03C5)  # upsilon
Ï†            →  φ  (U+03C6)  # phi
Ï‡            →  χ  (U+03C7)  # chi
Ïˆ            →  ψ  (U+03C8)  # psi
Ï‰            →  ω  (U+03C9)  # omega

# ==============================================================================
# LETTRES GRECQUES (MAJUSCULES)
# ==============================================================================

Î'            →  Α  (U+0391)  # Alpha
Î'            →  Β  (U+0392)  # Beta
Î"            →  Γ  (U+0393)  # Gamma
Î"            →  Δ  (U+0394)  # Delta
Îµ            →  Ε  (U+0395)  # Epsilon
Î–            →  Ζ  (U+0396)  # Zeta
Î—            →  Η  (U+0397)  # Eta
Î˜            →  Θ  (U+0398)  # Theta
Î™            →  Ι  (U+0399)  # Iota
Îš            →  Κ  (U+039A)  # Kappa
Î›            →  Λ  (U+039B)  # Lambda
Îœ            →  Μ  (U+039C)  # Mu
Î            →  Ν  (U+039D)  # Nu
Îž            →  Ξ  (U+039E)  # Xi
ÎŸ            →  Ο  (U+039F)  # Omicron
Î             →  Π  (U+03A0)  # Pi
Î¡            →  Ρ  (U+03A1)  # Rho
Î£            →  Σ  (U+03A3)  # Sigma
Î¤            →  Τ  (U+03A4)  # Tau
Î¥            →  Υ  (U+03A5)  # Upsilon
Î¦            →  Φ  (U+03A6)  # Phi
Î§            →  Χ  (U+03A7)  # Chi
Îª            →  Ψ  (U+03A8)  # Psi
Î©            →  Ω  (U+03A9)  # Omega

# ==============================================================================
# EXPOSANTS ET INDICES
# ==============================================================================

Â¹            →  ¹  (U+00B9)  # Superscript 1
Â²            →  ²  (U+00B2)  # Superscript 2
Â³            →  ³  (U+00B3)  # Superscript 3
â�´           →  ⁴  (U+2074)  # Superscript 4
â�µ           →  ⁵  (U+2075)  # Superscript 5
â�¶           →  ⁶  (U+2076)  # Superscript 6
â�·           →  ⁷  (U+2077)  # Superscript 7
â�¸           →  ⁸  (U+2078)  # Superscript 8
â�¹           →  ⁹  (U+2079)  # Superscript 9
â�º           →  ⁰  (U+2070)  # Superscript 0
á´µ            →  ⁱ  (U+2071)  # Superscript i
Ã‚Â¡         →  ⁱ  (U+2071)  # Forme corrompue de superscript i
âБ           →  ⁿ  (U+207F)  # Superscript n

â‚€           →  ₀  (U+2080)  # Subscript 0
â‚           →  ₁  (U+2081)  # Subscript 1
â‚‚           →  ₂  (U+2082)  # Subscript 2
â‚ƒ           →  ₃  (U+2083)  # Subscript 3
â‚„           →  ₄  (U+2084)  # Subscript 4
â‚…           →  ₅  (U+2085)  # Subscript 5
â‚†           →  ₆  (U+2086)  # Subscript 6
â‚‡           →  ₇  (U+2087)  # Subscript 7
â‚ˆ           →  ₈  (U+2088)  # Subscript 8
â‚‰           →  ₉  (U+2089)  # Subscript 9

# ==============================================================================
# ARTEFACTS D'ENCODAGE À SUPPRIMER
# ==============================================================================

Ã‚Â          →  (vide)       # Artefact UTF-8 corrompu
Ãƒ           →  (vide)       # Artefact UTF-8 corrompu
Â            →  (vide)       # Espace insécable corrompu (sauf si intentionnel)

# ==============================================================================
# CAS SPÉCIAL : REVOÎ vs REVOI
# ==============================================================================

# PROBLÈME IDENTIFIÉ:
# Le "Î" (I avec accent circonflexe, U+00CE) cause des conflits d'encodage
# quand mélangé avec des symboles mathématiques (⊗, δ, etc.) dans JSON-LD

REVOÃŽ        →  REVOI       # Forme corrompue
REVOÃ         →  REVOI       # Forme corrompue alternative  
REVOÎ         →  REVOI       # Même en forme correcte, à remplacer

# RECOMMANDATION FRAMEWORK:
# Utiliser systématiquement "REVOI" (avec I latin) au lieu de "REVOÎ"
# pour éviter les conflits d'encodage avec les symboles mathématiques

# Raison: Le Î (U+00CE, Latin Extended) et les symboles mathématiques
# (U+2200-U+22FF) utilisent des plages Unicode incompatibles qui se
# corrompent mutuellement lors de certaines opérations de
# sérialisation/désérialisation JSON.

# ==============================================================================
# EXEMPLES D'UTILISATION
# ==============================================================================

# Exemple 1: Formule tensorielle
# AVANT:  "formula": "AâŠ—SâŠ—F"
# APRÈS:  "formula": "A⊗S⊗F"

# Exemple 2: Quantificateur
# AVANT:  "âˆ€n, structure(level_n) â‰ structure(level_0)"
# APRÈS:  "∀n, structure(level_n) ≈ structure(level_0)"

# Exemple 3: Basis REVOI
# AVANT:  "basis": "REVOÃŽ"
# APRÈS:  "basis": "REVOI"

# Exemple 4: Epistemic gap avec delta
# AVANT:  "Î"(M) = ||P(Reality) - Model||âˆˆ [0,1]"
# APRÈS:  "δ(M) = ||P(Reality) - Model||∈ [0,1]"

# ==============================================================================
# SCRIPT PYTHON DE CORRECTION AUTOMATIQUE
# ==============================================================================

"""
import json

def fix_encoding(filepath):
    # Lire le fichier
    with open(filepath, 'r', encoding='utf-8') as f:
        content = f.read()
    
    # Dictionnaire de corrections
    corrections = {
        # Symboles mathématiques
        'âŠ—': '⊗',
        'Ã¢Å â€"': '⊗',
        'Ã¢â€ â€™': '⊗',
        'âˆˆ': '∈',
        'Î"': 'δ',
        'âˆ€': '∀',
        'âŠ•': '⊕',
        'â‰': '≈',
        'âŠ†': '⊆',
        'â‡': '⇒',
        'âˆž': '∞',
        'â‰¤': '≤',
        'â‰¥': '≥',
        'âŸ¨': '⟨',
        'âŸ©': '⟩',
        'âˆ'': '∑',
        'âˆ«': '∫',
        
        # Lettres grecques
        'Î±': 'α',
        'Î²': 'β',
        'Î³': 'γ',
        'Îµ': 'ε',
        'Î¸': 'θ',
        'Î»': 'λ',
        'Âµ': 'μ',
        'Ï€': 'π',
        'Ïƒ': 'σ',
        'Ï„': 'τ',
        'Ï‰': 'ω',
        
        # REVOI spécial
        'REVOÃŽ': 'REVOI',
        'REVOÃ': 'REVOI',
        'REVOÎ': 'REVOI',
        
        # Exposants
        'Ã‚Â¡': 'ⁱ',
        'Ã‚Âµ': 'μ',
        
        # Artefacts
        'Ã‚Â': '',
        'Ãƒ': '',
    }
    
    # Appliquer les corrections
    for wrong, right in corrections.items():
        count = content.count(wrong)
        if count > 0:
            content = content.replace(wrong, right)
            print(f"Corrigé {count} x {repr(wrong)}")
    
    # Sauvegarder
    with open(filepath, 'w', encoding='utf-8') as f:
        f.write(content)
    
    # Valider JSON
    try:
        with open(filepath, 'r') as f:
            json.load(f)
        print("✅ JSON validation: PASSED")
        return True
    except Exception as e:
        print(f"❌ JSON error: {e}")
        return False

# Utilisation
fix_encoding('/path/to/M2_MetaConcepts.jsonld')
"""

# ==============================================================================
# NOTES IMPORTANTES
# ==============================================================================

# 1. TOUJOURS utiliser encoding='utf-8' lors de la lecture/écriture de fichiers
# 2. TOUJOURS utiliser ensure_ascii=False dans json.dump() pour préserver Unicode
# 3. ÉVITER d'éditer manuellement avec des éditeurs qui ne supportent pas UTF-8
# 4. TESTER la validité JSON après chaque correction
# 5. GARDER des backups avant toute correction massive
# 6. Pour REVOI: utiliser systématiquement sans accent circonflexe

# ==============================================================================
# VALIDATION
# ==============================================================================

# Pour vérifier qu'un fichier n'a plus de corruption:
"""
import json

with open('file.jsonld', 'r') as f:
    content = f.read()

# Lister les patterns corrompus courants
corrupted = ['âŠ—', 'Ã¢', 'REVOÃŽ', 'Î"', 'âˆˆ', 'âˆ€']
found = [p for p in corrupted if p in content]

if found:
    print(f"❌ Corruptions trouvées: {found}")
else:
    print("✅ Aucune corruption détectée")
    
# Valider JSON
try:
    data = json.loads(content)
    print("✅ JSON valide")
except:
    print("❌ JSON invalide")
"""

# ==============================================================================
# FIN DU FICHIER DE CORRESPONDANCES
# ==============================================================================
